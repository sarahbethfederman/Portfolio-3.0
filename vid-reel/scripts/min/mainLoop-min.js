"use strict";var Slide=require("./slide.js"),dataLoader=require("./dataLoader.js"),videoModule=require("./video.js"),buttons=require("./buttons.js"),slideNav=require("./slideNav"),preloader=require("./preloader.js"),loop={videoData:void 0,slides:[],currentSlide:0,videoContainer:void 0,contentContainer:void 0,video:void 0,overlayOn:!1,timer:void 0,init:function(){var e=this,t=e.videoContainer.querySelector("progress");e.video=e.videoContainer.querySelector("video"),e.videoContainer.classList.add("fade-in"),e.contentContainer.classList.add("fade-in"),e.initEvents(this.video,t),e.mouseEffect(),dataLoader.getData(e.createSlides.bind(e))},mouseEffect:function(){var e=this,t=!1;e.startTimer(),e.contentContainer.addEventListener("mousemove",function(){e.showOverlay()})},startTimer:function(){var e=this;e.timer=setTimeout(function(){e.overlayOn&&(e.contentContainer.classList.remove("fade-in"),e.contentContainer.classList.add("fade-out"),e.video.classList.remove("blur"),e.overlayOn=!1,e.startTimer())},4e3)},showOverlay:function(){var e=this;clearTimeout(e.timer),e.video.classList.add("blur"),e.contentContainer.classList.remove("fade-out"),e.contentContainer.classList.add("fade-in"),e.overlayOn=!0,e.video.classList.contains("filler")||e.startTimer()},createSlides:function(e){this.videoData=e;var t=this;slideNav.init(t.videoData,function(e){t.next(e),slideNav.move(e,t.currentSlide)});for(var i in this.videoData)if(this.videoData.hasOwnProperty(i)){var n=new Slide(this.videoData[i],this.videoContainer,this.contentContainer);n.key=i,t.slides.push(n)}this.startLoop()},initEvents:function(e,t){var i=this;e.load(),e.addEventListener("loadstart",function(){videoModule.loaderStart(i.videoContainer,i.video),console.log("loadstarted")}),e.addEventListener("canplaythrough",function(){videoModule.loaderEnd(i.videoContainer,i.video),console.log("canplaythrough")}),e.addEventListener("timeupdate",function(){videoModule.progressBar(e,t)}),e.addEventListener("ended",function(){i.next()}),buttons.initVidBtns(this.contentContainer.querySelector(".video-controls"),e)},startLoop:function(){this.currentSlide=0,this.next()},next:function(e){var t=this;t.video.pause(),t.currentSlide>t.slides.length-1&&(t.currentSlide=0),e?(0==t.currentSlide?t.slides[t.slides.length-1].cycleOut():t.slides[t.currentSlide-1].cycleOut(),setTimeout(function(){t.slides[e].cycleIn(),t.showOverlay(),t.currentSlide=e,t.currentSlide++},300)):(0==t.currentSlide?t.slides[t.slides.length-1].cycleOut():t.slides[t.currentSlide-1].cycleOut(),setTimeout(function(){t.slides[t.currentSlide].cycleIn(),t.showOverlay(),t.currentSlide++},300))}};module.exports=loop;